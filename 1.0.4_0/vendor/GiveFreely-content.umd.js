!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).GiveFreely={})}(this,(function(e){"use strict";const t={equals:(e,t)=>e===t};let n=k;const r=1,o=2,i={owned:null,cleanups:null,context:null,owner:null};var s=null;let a=null,l=null,c=null,u=null,g=0;function d(e,n){const r={value:e,observers:null,observerSlots:null,comparator:(n=n?Object.assign({},t,n):t).equals||void 0};return[b.bind(r),e=>("function"==typeof e&&(e=e(r.value)),x(r,e))]}function p(e,t,n){v(y(e,t,!1,r))}function h(e,t,o){n=P;const i=y(e,t,!1,r);i.user=!0,u?u.push(i):v(i)}function m(e,n,r){r=r?Object.assign({},t,r):t;const o=y(e,n,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=r.equals||void 0,v(o),b.bind(o)}function f(e){if(null===l)return e();const t=l;l=null;try{return e()}finally{l=t}}function A(e){h((()=>f(e)))}function b(){if(this.sources&&this.state)if(this.state===r)v(this);else{const e=c;c=null,C((()=>S(this)),!1),c=e}if(l){const e=this.observers?this.observers.length:0;l.sources?(l.sources.push(this),l.sourceSlots.push(e)):(l.sources=[this],l.sourceSlots=[e]),this.observers?(this.observers.push(l),this.observerSlots.push(l.sources.length-1)):(this.observers=[l],this.observerSlots=[l.sources.length-1])}return this.value}function x(e,t,n){let o=e.value;return e.comparator&&e.comparator(o,t)||(e.value=t,e.observers&&e.observers.length&&C((()=>{for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t],o=a&&a.running;o&&a.disposed.has(n),(o?n.tState:n.state)||(n.pure?c.push(n):u.push(n),n.observers&&E(n)),o||(n.state=r)}if(c.length>1e6)throw c=[],new Error}),!1)),t}function v(e){if(!e.fn)return;T(e);const t=g;!function(e,t,n){let o;const i=s,a=l;l=s=e;try{o=e.fn(t)}catch(t){return e.pure&&(e.state=r,e.owned&&e.owned.forEach(T),e.owned=null),e.updatedAt=n+1,O(t)}finally{l=a,s=i}(!e.updatedAt||e.updatedAt<=n)&&(null!=e.updatedAt&&"observers"in e?x(e,o):e.value=o,e.updatedAt=n)}(e,e.value,t)}function y(e,t,n,o=r,a){const l={fn:e,state:o,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:s,context:s?s.context:null,pure:n};return null===s||s!==i&&(s.owned?s.owned.push(l):s.owned=[l]),l}function w(e){if(0===e.state)return;if(e.state===o)return S(e);if(e.suspense&&f(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<g);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if((e=t[n]).state===r)v(e);else if(e.state===o){const n=c;c=null,C((()=>S(e,t[0])),!1),c=n}}function C(e,t){if(c)return e();let r=!1;t||(c=[]),u?r=!0:u=[],g++;try{const t=e();return function(e){if(c&&(k(c),c=null),e)return;const t=u;u=null,t.length&&C((()=>n(t)),!1)}(r),t}catch(e){r||(u=null),c=null,O(e)}}function k(e){for(let t=0;t<e.length;t++)w(e[t])}function P(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:w(r)}for(t=0;t<n;t++)w(e[t])}function S(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const i=e.sources[n];if(i.sources){const e=i.state;e===r?i!==t&&(!i.updatedAt||i.updatedAt<g)&&w(i):e===o&&S(i,t)}}}function E(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=o,n.pure?c.push(n):u.push(n),n.observers&&E(n))}}function T(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),r=t.observers;if(r&&r.length){const e=r.pop(),o=t.observerSlots.pop();n<r.length&&(e.sourceSlots[o]=n,r[n]=e,t.observerSlots[n]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)T(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)T(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function O(e,t=s){const n=function(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}(e);throw n}function D(e,t){return f((()=>e(t||{})))}function I(e){const t=e.keyed,n=m((()=>e.when),void 0,{equals:(e,n)=>t?e===n:!e==!n});return m((()=>{const r=n();if(r){const o=e.children;return"function"==typeof o&&o.length>0?f((()=>o(t?r:()=>{if(!f(n))throw"Stale read from <Show>.";return e.when}))):o}return e.fallback}),void 0,void 0)}const R="_$DX_DELEGATE";function _(e,t,n){let r;const o=()=>{const t=document.createElement("template");return t.innerHTML=e,t.content.firstChild},i=t?()=>f((()=>document.importNode(r||(r=o()),!0))):()=>(r||(r=o())).cloneNode(!0);return i.cloneNode=i,i}function N(e,t=window.document){const n=t[R]||(t[R]=new Set);for(let r=0,o=e.length;r<o;r++){const o=e[r];n.has(o)||(n.add(o),t.addEventListener(o,M))}}function L(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function F(e,t,n){if(!t)return n?L(e,"style"):t;const r=e.style;if("string"==typeof t)return r.cssText=t;let o,i;for(i in"string"==typeof n&&(r.cssText=n=void 0),n||(n={}),t||(t={}),n)null==t[i]&&r.removeProperty(i),delete n[i];for(i in t)o=t[i],o!==n[i]&&(r.setProperty(i,o),n[i]=o);return n}function $(e,t,n,r){if(void 0===n||r||(r=[]),"function"!=typeof t)return U(e,t,r,n);p((r=>U(e,t(),r,n)),r)}function M(e){let t=e.target;const n=`$$${e.type}`,r=e.target,o=e.currentTarget,i=t=>Object.defineProperty(e,"target",{configurable:!0,value:t}),s=()=>{const r=t[n];if(r&&!t.disabled){const o=t[`${n}Data`];if(void 0!==o?r.call(t,o,e):r.call(t,e),e.cancelBubble)return}return t.host&&"string"!=typeof t.host&&!t.host._$host&&t.contains(e.target)&&i(t.host),!0},a=()=>{for(;s()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>t||document}),e.composedPath){const n=e.composedPath();i(n[0]);for(let e=0;e<n.length-2&&(t=n[e],s());e++){if(t._$host){t=t._$host,a();break}if(t.parentNode===o)break}}else a();i(r)}function U(e,t,n,r,o){for(;"function"==typeof n;)n=n();if(t===n)return n;const i=typeof t,s=void 0!==r;if(e=s&&n[0]&&n[0].parentNode||e,"string"===i||"number"===i){if("number"===i&&(t=t.toString())===n)return n;if(s){let o=n[0];o&&3===o.nodeType?o.data!==t&&(o.data=t):o=document.createTextNode(t),n=B(e,n,r,o)}else n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t}else if(null==t||"boolean"===i)n=B(e,n,r);else{if("function"===i)return p((()=>{let o=t();for(;"function"==typeof o;)o=o();n=U(e,o,n,r)})),()=>n;if(Array.isArray(t)){const i=[],a=n&&Array.isArray(n);if(G(i,t,n,o))return p((()=>n=U(e,i,n,r,!0))),()=>n;if(0===i.length){if(n=B(e,n,r),s)return n}else a?0===n.length?H(e,i,r):function(e,t,n){let r=n.length,o=t.length,i=r,s=0,a=0,l=t[o-1].nextSibling,c=null;for(;s<o||a<i;)if(t[s]!==n[a]){for(;t[o-1]===n[i-1];)o--,i--;if(o===s){const t=i<r?a?n[a-1].nextSibling:n[i-a]:l;for(;a<i;)e.insertBefore(n[a++],t)}else if(i===a)for(;s<o;)c&&c.has(t[s])||t[s].remove(),s++;else if(t[s]===n[i-1]&&n[a]===t[o-1]){const r=t[--o].nextSibling;e.insertBefore(n[a++],t[s++].nextSibling),e.insertBefore(n[--i],r),t[o]=n[i]}else{if(!c){c=new Map;let e=a;for(;e<i;)c.set(n[e],e++)}const r=c.get(t[s]);if(null!=r)if(a<r&&r<i){let l,u=s,g=1;for(;++u<o&&u<i&&null!=(l=c.get(t[u]))&&l===r+g;)g++;if(g>r-a){const o=t[s];for(;a<r;)e.insertBefore(n[a++],o)}else e.replaceChild(n[a++],t[s++])}else s++;else t[s++].remove()}}else s++,a++}(e,n,i):(n&&B(e),H(e,i));n=i}else if(t.nodeType){if(Array.isArray(n)){if(s)return n=B(e,n,r,t);B(e,n,null,t)}else null!=n&&""!==n&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);n=t}}return n}function G(e,t,n,r){let o=!1;for(let i=0,s=t.length;i<s;i++){let s,a=t[i],l=n&&n[e.length];if(null==a||!0===a||!1===a);else if("object"==(s=typeof a)&&a.nodeType)e.push(a);else if(Array.isArray(a))o=G(e,a,l)||o;else if("function"===s)if(r){for(;"function"==typeof a;)a=a();o=G(e,Array.isArray(a)?a:[a],Array.isArray(l)?l:[l])||o}else e.push(a),o=!0;else{const t=String(a);l&&3===l.nodeType&&l.data===t?e.push(l):e.push(document.createTextNode(t))}}return o}function H(e,t,n=null){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function B(e,t,n,r){if(void 0===n)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let r=!1;for(let i=t.length-1;i>=0;i--){const s=t[i];if(o!==s){const t=s.parentNode===e;r||i?t&&s.remove():t?e.replaceChild(o,s):e.insertBefore(o,n)}else r=!0}}else e.insertBefore(o,n);return[o]}class j{log({level:e,message:t,timestamp:n,data:r,title:o}){const i="debug"===e?"log":e,s=o?`[${o}]`:"";void 0!==r?console[i](`[${n}] - ${j.LOGGER_PREFIX} ${s} ${t}`,r):console[i](`[${n}] - ${j.LOGGER_PREFIX} ${s} ${t}`)}}var K,W;j.LOGGER_PREFIX="[GFAdUnit] -",function(e){e.checkoutPopupShown="CHECKOUT-POPUP-SHOWN",e.checkoutPopupNotShown="CHECKOUT-POPUP-NOT-SHOWN",e.checkoutPopupSupressed="CHECKOUT-POPUP-SUPRESSED",e.checkoutPopupDonation="CHECKOUT-POPUP-DONATION",e.checkoutPopupFailedActivation="CHECKOUT-POPUP-FAILED-ACTIVATION",e.checkoutPopupPurchaseConfirmed="CHECKOUT-POPUP-PURCHASE-CONFIRMED",e.checkoutPopupHealthCheck="CHECKOUT-POPUP-HEALTH-CHECK",e.checkouPopupActivationFailed="CHECKOUT-POPUP-ACTIVATION-FAILED",e.checkoutPopupOfferDetailsClicked="CHECKOUT-POPUP-OFFER-DETAILS-CLICKED",e.checkoutPopupWhyAmISeeingThisClicked="CHECKOUT-POPUP-WHY-AM-I-SEEING-THIS-CLICKED",e.checkoutPopupLooserExtension="CHECKOUT-POPUP-LOOSER-EXTENSION",e.checkoutPopupActiveDomain="CHECKOUT-POPUP-ACTIVE-DOMAIN",e.checkoutPopupSiteMatches="CHECKOUT-POPUP-SITE-MATCHES"}(K||(K={})),function(e){e.adUnitLog="ADUNIT-LOG"}(W||(W={}));const V=["debug","info","warn","error"];class Y{constructor(e){this.config={minLevel:e?.minLevel??"debug",enabled:e?.enabled??!1,transports:e?.transports??[new j],title:e?.title??""}}static getInstance(e){return Y.instance||(Y.instance=new Y(e)),Y.instance}configure(e){this.config={...this.config,...e}}shouldLog(e){return!!this.config.enabled&&V.indexOf(e)>=V.indexOf(this.config.minLevel)}createLogMessage(e,t,n){return{level:e,version:"1.5.1",message:t,timestamp:(new Date).toISOString(),data:n,title:this.config.title}}log(e,t,n){if(!this.shouldLog(e))return;const r=this.createLogMessage(e,t,n);this.config.transports.forEach((e=>e.log(r)))}debug(e,t){this.log("debug",e,t)}info(e,t){this.log("info",e,t)}warn(e,t){this.log("warn",e,t)}error(e,t){this.log("error",e,t)}addTransport(e){this.config.transports.push(e)}clearTransports(){this.config.transports=[]}disable(){this.config.enabled=!1}enable(){this.config.enabled=!0}}const z=3,q=e=>1e3*e;async function X(e,t={}){const{maxAttempts:n=z,delayFn:r=q}=t;let o=null;for(let t=1;t<=n;t+=1)try{return await e()}catch(e){o=e,t<n&&await new Promise((e=>{setTimeout(e,r(t))}))}throw o||new Error("Operation failed after multiple attempts")}const Z=chrome;async function J(e,t){return new Promise(((n,r)=>{try{const o=t=>chrome.runtime.lastError?r({error:chrome.runtime.lastError,message:e}):n(t);t?.tabId||Z.runtime.sendMessage(e,o)}catch(e){r(e)}}))}async function Q(e,t,n){return X((()=>J(e,t)),{maxAttempts:z,delayFn:q})}const ee={display:"block",position:"fixed",top:"0%",left:"100%",width:"500px",height:"520px","margin-left":"-560px","margin-top":"50px",padding:"2px 5px","background-color":"white",border:"1px solid black","border-radius":"10px","box-shadow":"0 2px 10px rgba(0, 0, 0, 0.1)","z-index":"2147483647","font-family":"Arial","line-height":"1","vertical-align":"baseline","box-sizing":"border-box",color:"rgb(34, 34, 34)","@media (max-width: 600px), (max-height: 480px)":{display:"none !important"}},te={height:"100%","overflow-x":"hidden","overlfow-y":"auto",position:"relative",padding:"0px 15px"},ne={},re={display:"flex","align-items":"center","margin-bottom":"10px"},oe={flex:"1","font-size":"24px","font-weight":"700","margin-top":"20px","margin-bottom":"0px"},ie={background:"none",border:"none",padding:"4px 8px",color:"#666464","font-size":"38px",cursor:"pointer","line-height":"1"},se={color:"black","margin-top":"20px","max-width":"40%"},ae={color:"gray",cursor:"default","pointer-events":"none","text-decoration":"none"},le={"font-size":"18px","font-weight":"400","margin-top":"20px","margin-bottom":"0px"},ce={display:"flex",gap:"10px",width:"100%","margin-top":"20px","margin-bottom":"20px","flex-wrap":"wrap","justify-content":"space-between"},ue={width:"28%",position:"relative",display:"flex","flex-direction":"column","align-items":"center",background:"none",border:"1px solid #ccc","border-radius":"5px",padding:"5px",gap:"5px","text-align":"center","font-size":"14px",cursor:"pointer",transition:"background-color 0.2s ease"},ge={color:"white","background-color":"lightgray",cursor:"default","pointer-events":"none"},de={"max-width":"120px","max-height":"70px","margin-bottom":"5px","object-fit":"contain"},pe={"background-color":"#FFD812",cursor:"pointer","border-radius":"8px",padding:"8px",color:"white","min-width":"100px",border:"0","font-weight":"600",width:"100%"},he={display:"flex","flex-direction":"column",gap:"10px",width:"100%","color-scheme":"light"},me={display:"flex","align-items":"center",gap:"5px",border:"1px solid #ddd",padding:"15px","border-radius":"5px","font-weight":"600",cursor:"pointer","margin-bottom":"8px"},fe={"text-align":"right"},Ae={background:"none",border:"none",color:"blue","text-decoration":"underline",padding:"0",cursor:"pointer","margin-bottom":"15px"},be={display:"flex","justify-content":"space-between",margin:"20px 0px 10px 0px","font-size":"14px"},xe={margin:"5px 0px 5px 0px","font-size":"14px","text-align":"center"},ve={color:"#666464","text-decoration":"underline"},ye={color:"rgb(102, 100, 100)","text-decoration":"underline",margin:"0",cursor:"pointer"},we={width:"100%","background-color":"#f2f2f2",border:"1px solid black","border-radius":"10px","border-top":"1px solid #bbb7b7","margin-top":"10px","margin-bottom":"20px","box-sizing":"border-box"},Ce={padding:"0 5px 0 10px",width:"100%","font-size":"12px","box-sizing":"border-box"},ke={display:"grid","grid-template-columns":"4fr 1fr","padding-right":"15px","padding-bottom":"5px"},Pe={color:"#000","margin-bottom":"4px"},Se={"font-size":"14px",color:"#555","text-align":"right"},Ee=(e,t)=>{let n=parseFloat(t);return"FLAT"===e&&(n*=.75),((e,t)=>{let n=parseFloat(t);return n<1&&(n=1),n=Math.floor(n),"PERCENTAGE"===e?`${n}%`:`$${n}`})(e,n.toString())};var Te=_("<span>");function Oe(e){return t=Te(),p((()=>{return t.innerHTML=(n=e.title,r=e.activeDomain,n.replace("{0}",Ee(r.Merchant.MaxRate?.Kind,r.Merchant.MaxRate?.Amount??"0")));var n,r})),t;var t}var De=_("<div>"),Ie=_("<div><div class=gf-offer-details><p>Select a charity to activate a donation during your online shopping session.</p><p> <b>Eligible Transaction:</b> A purchase made immediately after selecting a charity.</p><p><b>Donation rates:</b> <!> for each eligible transaction. The following donation rates and exclusions apply:</p><p><b>Donation amounts:</b> Donation amount is calculated based upon the applicable rates and exclusions, which may change from time to time. Amounts may be adjusted or canceled due to returned items, suspected fraud, or other factors described within the terms and conditions.</p><p><b>Donation timing:</b> On average, donation payouts occur 60-120 days after your completed transaction, but some donations may take 180 days or longer. We provide a donation to the charity you had selected at the time of purchase, in monthly batches, after any holdback periods due to applicable return or cancellation policies have passed.</p><p>See a summary of  <a target=_blank rel=noreferrer>terms and conditions</a>."),Re=_("<div class=gf-offer-details-rate-item><div></div><div>");const _e=e=>{return t=Ie(),o=(r=(n=t.firstChild).firstChild.nextSibling.nextSibling).firstChild.nextSibling.nextSibling,i=r.nextSibling,s=i.nextSibling.nextSibling.firstChild.nextSibling,$(r,(()=>e.parsedMaxRate?`Up to ${e.parsedMaxRate}`:"Earn"),o),$(n,D(I,{get when(){return!!e.merchantRateDetail?.length},get children(){var t=De();return $(t,(()=>e.merchantRateDetail?.map((e=>{return t=Re(),n=t.firstChild,r=n.nextSibling,$(n,(()=>e.Name||"")),$(r,(()=>((e,t=1,n=1)=>{const r=e.BoostedOffer??null;let o=parseFloat(e?.Amount??"");if(r?.EndDate&&new Date(r.EndDate)<new Date&&(o=parseFloat(r.OriginalMaxRate)),Number.isNaN(o))return"";const i=o*t;return"PERCENTAGE"===e?.Kind?`${i.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:n})}%`:"FLAT"===e?.Kind?i.toLocaleString("en-US",{style:"currency",currency:e.Currency}):""})(e))),p((e=>{var o=ke,i=Pe,s=Se;return e.e=F(t,o,e.e),e.t=F(n,i,e.t),e.a=F(r,s,e.a),e}),{e:void 0,t:void 0,a:void 0}),t;var t,n,r})))),t}}),i),p((r=>{var o=we,i=Ce,a=ve,l=e.termsUrl;return r.e=F(t,o,r.e),r.t=F(n,i,r.t),r.a=F(s,a,r.a),l!==r.o&&L(s,"href",r.o=l),r}),{e:void 0,t:void 0,a:void 0,o:void 0}),t;var t,n,r,o,i,s};function Ne(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var Le={exports:{}};!function(e){"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(e){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const o=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},i=e=>1==e?"argument":"arguments",s=(e,t,n)=>new Proxy(t,{apply:(t,r,o)=>n.call(r,e,...o)});let a=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},n={})=>{let r=Object.create(null),c={has:(t,n)=>n in e||n in r,get(c,u,g){if(u in r)return r[u];if(!(u in e))return;let d=e[u];if("function"==typeof d)if("function"==typeof t[u])d=s(e,e[u],t[u]);else if(a(n,u)){let t=((e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${i(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${i(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((i,s)=>{if(t.fallbackToNoCallback)try{n[e](...r,o({resolve:i,reject:s},t))}catch(o){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,i()}else t.noCallback?(n[e](...r),i()):n[e](...r,o({resolve:i,reject:s},t))}))})(u,n[u]);d=s(e,e[u],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(a(t,u)||a(n,u)))d=l(d,t[u],n[u]);else{if(!a(n,"*"))return Object.defineProperty(r,u,{configurable:!0,enumerable:!0,get:()=>e[u],set(t){e[u]=t}}),d;d=l(d,t[u],n["*"])}return r[u]=d,d},set:(t,n,o,i)=>(n in r?r[n]=o:e[n]=o,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},u=Object.create(e);return new Proxy(u,c)},c=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),u=new r((e=>"function"!=typeof e?e:function(t){const n=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),g=new r((e=>"function"!=typeof e?e:function(t,n,r){let o,i,s=!1,a=new Promise((e=>{o=function(t){s=!0,e(t)}}));try{i=e(t,n,o)}catch(e){i=Promise.reject(e)}const l=!0!==i&&((c=i)&&"object"==typeof c&&"function"==typeof c.then);var c;if(!0!==i&&!l&&!s)return!1;return(l?i:a).then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),d=({reject:n,resolve:r},o)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):o&&o.__mozWebExtensionPolyfillReject__?n(new Error(o.message)):r(o)},p=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${i(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${i(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const o=d.bind(null,{resolve:e,reject:t});r.push(o),n.sendMessage(...r)}))},h={devtools:{network:{onRequestFinished:c(u)}},runtime:{onMessage:c(g),onMessageExternal:c(g),sendMessage:p.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:p.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},m={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":m},services:{"*":m},websites:{"*":m}},l(e,h,n)};e.exports=n(chrome)}}(e)}(Le);var Fe=Ne(Le.exports);const $e="GIVE_FREELY_",Me={async get(e){const t=`${$e}${e}`;return(await Fe.storage.local.get(t))[t]||null},async set(e,t){const n=`${$e}${e}`;await Fe.storage.local.set({[n]:t})},async remove(e){const t=Array.isArray(e)?e.map((e=>`${$e}${e}`)):`${$e}${e}`;await Fe.storage.local.remove(t)}};class Ue{constructor(e){this.partnerApiKey=e,this.partnerConfig=null,this.globalConfig=null,this.lastConfigRefresh=0,this.CONFIG_REFRESH_INTERVAL=3e5,this.PARTNER_CONFIG_STORAGE_KEY="gf_partner_config",this.GLOBAL_CONFIG_STORAGE_KEY="gf_global_config"}getRetryOptions(){return{delayFn:e=>1e3*e,maxAttempts:3}}async fetchAndUpdatePartnerConfig(){const e=await X((async()=>{const e=await fetch(`https://cdn.givefreely.com/adunit/config/${this.partnerApiKey}.json`,{cache:"no-store"});if(!e.ok)throw new Error(`Failed to fetch partner config: ${e.statusText}`);return e.json()}),this.getRetryOptions()),t={config:e,lastRefresh:Date.now()};return await Me.set(this.PARTNER_CONFIG_STORAGE_KEY,t),e}async fetchAndUpdateGlobalConfig(){const e=await X((async()=>{const e=await fetch("https://cdn.givefreely.com/adunit/config/global.json",{cache:"no-store"});if(!e.ok)throw new Error(`Failed to fetch global config: ${e.statusText}`);return e.json()}),this.getRetryOptions()),t={config:e,lastRefresh:Date.now()};return await Me.set(this.GLOBAL_CONFIG_STORAGE_KEY,t),e}async getConfig(){const e=Date.now(),t=await Me.get(this.PARTNER_CONFIG_STORAGE_KEY),n=await Me.get(this.GLOBAL_CONFIG_STORAGE_KEY);if(this.partnerConfig=t?.config||null,this.globalConfig=n?.config||null,this.lastConfigRefresh=Math.max(t?.lastRefresh||0,n?.lastRefresh||0),!this.partnerConfig||!this.globalConfig||e-this.lastConfigRefresh>this.CONFIG_REFRESH_INTERVAL)try{const[t,n]=await Promise.all([this.fetchAndUpdatePartnerConfig(),this.fetchAndUpdateGlobalConfig()]);this.partnerConfig=t,this.globalConfig=n,this.lastConfigRefresh=e}catch(e){if(!this.partnerConfig||!this.globalConfig)throw e}const r=this.mergeConfigs(this.globalConfig,this.partnerConfig);return((e,t,n)=>{const r=[...t.merchantExclusions??[],...n.merchantExclusions??[]];e.merchantExclusions=r})(r,this.globalConfig,this.partnerConfig),r}async clearCache(){await Promise.all([Me.remove(this.PARTNER_CONFIG_STORAGE_KEY),Me.remove(this.GLOBAL_CONFIG_STORAGE_KEY)]),this.partnerConfig=null,this.globalConfig=null,this.lastConfigRefresh=0}mergeConfigs(e,t){if(!t)return e;const n={...e};return Object.keys(t).forEach((r=>{if(!Object.prototype.hasOwnProperty.call(t,r))return;const o=e[r],i=t[r];Array.isArray(i)&&Array.isArray(o)?n[r]=i:n[r]=null===i||"object"!=typeof i||"object"!=typeof o?void 0!==i?i:o:this.mergeConfigs(o,i)})),n}getStoredState(e){return e?{config:e.config,lastRefresh:e.lastRefresh}:{config:null,lastRefresh:0}}}const Ge="TRACK_EVENT",He="GF_HIDE_POPUP",Be="GF_GET_POPUP_CONFIG",je="GF_IS_ACTIVE_DOMAIN",Ke="GF_SHOULD_STAND_DOWN",We="GF_ACTIVATE_OFFER",Ve="GF_STORE_SHOPIFY_SHOP_ID",Ye="GF_GET_DOMAIN_BY_SHOP_ID",ze={ein:"0",tpi:"0",logo:"",title:"Unknown Charity"},qe=()=>String("1.5.1");class Xe{constructor(e,t,n=60){this._config=null,this.track=async(e,t,n,r=!1)=>{null===this._config&&(this._config=await new Ue(this._partnerApiKey).getConfig());const o={partner:`adUnit_${this._partnerApiKey}`,eventType:e,eventData:{userId:r?void 0:this._userService?.user?.id,libVersion:qe(),wfDeviceId:t,...n}};try{const e=JSON.stringify(o);return await this.shouldBroadcastEvent(e)?(await fetch(this._config.eventsUrl,{headers:{"Content-Type":"application/json"},method:"POST",body:e,cache:"no-store"}),await this.pushEventToHistory(e),!0):(this._logger.info("This event has already been broadcasted during the past hour",o),!1)}catch(e){return this._logger.info("Something unexpected happened when dispatching a gf event",{error:e,event:o}),!1}},this.getEventsHistory=async()=>{const{GF_AD_EVENT_HISTORY:e}=await Z.storage.local.get({GF_AD_EVENT_HISTORY:""}),t=(e=>{const t=new Date;return t.setTime(t.getTime()+60*e*1e3),t.getTime()})(-this._debounceWindowInMinutes),n=(e||[]).filter((e=>e.createdAt>t));return await Z.storage.local.set({GF_AD_EVENT_HISTORY:n}),n},this.shouldBroadcastEvent=async e=>!(await this.getEventsHistory()).some((t=>t.payload===e)),this.pushEventToHistory=async e=>{const t=await this.getEventsHistory();t.push({createdAt:Date.now(),payload:e}),await Z.storage.local.set({GF_AD_EVENT_HISTORY:t})},this._partnerApiKey=e,this._userService=t,this._debounceWindowInMinutes=n,this._logger=Y.getInstance({title:"Analytics"})}}function Ze(e,t,n){return e?{...t,...n}:t}Xe.trackEvent=async(e,t,n=!1)=>{await J({type:Ge,payload:{eventType:e,eventData:t,anonymous:n}})};var Je=_("<a href=#!>"),Qe=_("<button class=give-freely-close-button aria-label=Close>×"),et=_('<div><div><div><span></span></div></div><hr><div></div><div><div><div><br><span></span></div><button aria-label="Don\'t show again"></button></div></div><div><p></p><a class=give-freely-footer-link target=_blank rel="noopener noreferrer">'),tt=_("<div><div><img><span></span></div><button>"),nt=_("<div>");function rt(e){const[t,n]=d(!1),[r,o]=d(null);h((()=>{t()&&e.mainContainerRef&&e.mainContainerRef.scroll({top:e.mainContainerRef.scrollHeight,behavior:"smooth"})})),h((()=>{const t=r();t&&e.onCharitySelect(t.charity,t.closeOnDonation?e.checkoutPopupConf.checkoutPopupActivateAndCloseSkipSuccess:void 0)}));const i=(e,t)=>o({charity:e,closeOnDonation:t}),s=()=>!!r()?.charity;return[(l=et(),c=l.firstChild,u=c.firstChild,g=u.firstChild,f=c.nextSibling.nextSibling,A=f.nextSibling,b=A.firstChild,x=b.firstChild,v=x.firstChild.nextSibling,y=x.nextSibling,w=A.nextSibling,C=w.firstChild,k=C.nextSibling,$(c,D(I,{get when(){return e.checkoutPopupConf.checkoutPopupActivateAndClose},get children(){var t=Je();return t.$$click=()=>i(ze,!0),p((n=>{var r=Ze(s(),se,ae),o=e.checkoutPopupConf.checkoutPopupActivateAndClose;return n.e=F(t,r,n.e),o!==n.t&&(t.innerHTML=n.t=o),n}),{e:void 0,t:void 0}),t}}),null),$(c,D(I,{get when(){return e.checkoutPopupConf.checkoutPopupMainCloseButtonVisible&&!e.checkoutPopupConf.checkoutPopupActivateAndClose},get children(){var t=Qe();return t.$$click=()=>e.onClose(),p((e=>F(t,ie,e))),t}}),null),$(f,D(Oe,{get title(){return e.subtitle},get activeDomain(){return e.activeDomain}})),$(A,(()=>e.checkoutPopupConf.checkoutPopupCharities.map((t=>{return o=(r=tt()).firstChild,l=(a=o.firstChild).nextSibling,c=o.nextSibling,r.$$click=()=>!s()&&i(t),$(r,(n=m((()=>!!(t.decorator&&t.decoratorLeftStyle&&t.decoratorRightStyle))),()=>{return n()&&[(r=nt(),p((e=>{var n=t.decoratorLeftStyle,o=t.decorator;return e.e=F(r,n,e.e),o!==e.t&&(r.innerHTML=e.t=o),e}),{e:void 0,t:void 0}),r),(e=nt(),p((n=>{var r=t.decoratorRightStyle,o=t.decorator;return n.e=F(e,r,n.e),o!==n.t&&(e.innerHTML=n.t=o),n}),{e:void 0,t:void 0}),e)];var e,r}),o),o.style.setProperty("height","100px"),o.style.setProperty("text-align","center"),$(l,(()=>t.title)),$(c,(()=>e.checkoutPopupConf.checkoutPopupCharitySelectString||"Select")),p((n=>{var o=Ze(s(),ue,{cursor:"default"}),i=t.logo,l=de,u=t.title,g=Ze(s(),{...pe,"background-color":e.checkoutPopupConf.checkoutPopupSelectCharityButtonBgColor||"#FFD812"},ge),d=s(),p=`Select charity: ${t.title}`;return n.e=F(r,o,n.e),i!==n.t&&L(a,"src",n.t=i),n.a=F(a,l,n.a),u!==n.o&&L(a,"alt",n.o=u),n.i=F(c,g,n.i),d!==n.n&&(c.disabled=n.n=d),p!==n.s&&L(c,"aria-label",n.s=p),n}),{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),r;var n,r,o,a,l,c}))),b),b.$$click=()=>!s()&&e.onSuppress(),x.style.setProperty("height","100px"),x.style.setProperty("text-align","center"),$(y,(()=>e.checkoutPopupConf.checkoupPopupDontShowAgainButtonText||"Settings...")),C.$$click=()=>{e.onOfferDetailsClick(!t()),n(!t())},$(C,(()=>e.checkoutPopupConf.checkoutPopupOfferDetailsLabelString||"Offer Details")),k.$$click=()=>{Xe.trackEvent(K.checkoutPopupWhyAmISeeingThisClicked,{domain:globalThis.window.location.hostname})},$(k,(()=>e.checkoutPopupConf.checkoutPopupWhyAmISeeingThisLabelString||"Why am I seeing this?")),$(l,(a=m((()=>!!e.checkoutPopupConf.checkoutPopupDisplayNameInFooter)),()=>{return a()&&(t=nt(),p((n=>{var r=xe,o=e.checkoutPopupConf.checkoutPopupDisplayNameInFooter;return n.e=F(t,r,n.e),o!==n.t&&(t.innerHTML=n.t=o),n}),{e:void 0,t:void 0}),t);var t}),null),p((t=>{var n=ne,r=re,o=oe,i=e.checkoutPopupConf.checkoutPopupMainTitle,a=le,d=ce,p=Ze(s(),ue,{cursor:"default"}),h=e.checkoutPopupConf.checkoutPopupSixthBoxWording,m=Ze(s(),{...pe,"background-color":e.checkoutPopupConf.checkoutPopupSelectCharityButtonBgColor||"#FFD812"},ge),x=s(),P=be,S=ye,E=ve,T=e.checkoutPopupConf.externalUrls.giveFreelyWhyAmISeeingThis;return t.e=F(l,n,t.e),t.t=F(c,r,t.t),t.a=F(u,o,t.a),i!==t.o&&(g.innerHTML=t.o=i),t.i=F(f,a,t.i),t.n=F(A,d,t.n),t.s=F(b,p,t.s),h!==t.h&&(v.innerHTML=t.h=h),t.r=F(y,m,t.r),x!==t.d&&(y.disabled=t.d=x),t.l=F(w,P,t.l),t.u=F(C,S,t.u),t.c=F(k,E,t.c),T!==t.w&&L(k,"href",t.w=T),t}),{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),l),D(I,{get when(){return t()},get children(){return D(_e,{get merchantName(){return e.activeDomain.Merchant.Name},get extensionName(){return e.checkoutPopupConf.displayName},get termsUrl(){return e.checkoutPopupConf.externalUrls.giveFreelyTermsAndConditions},get parsedMaxRate(){return m((()=>!!e.activeDomain.Merchant.MaxRate))()?Ee(e.activeDomain.Merchant.MaxRate.Kind,e.activeDomain.Merchant.MaxRate?.Amount):null},get merchantRateDetail(){return e.merchantRates},onClose:()=>n(!1)})}})];var a,l,c,u,g,f,A,b,x,v,y,w,C,k}N(["click"]);var ot=_("<button class=give-freely-close-button aria-label=Close>×"),it=_("<label class=give-freely-radio-option><input type=radio name=gf-rad-goodbye value=18250><span>Don't ask me again... ever"),st=_("<div><div><div></div></div><button class=give-freely-back-button aria-label=\"Back to charity selection\">I changed my mind! I'd like to select a charity.</button><hr><div id=give-freely-goodbye-screen-options><label class=give-freely-radio-option><input type=radio name=gf-rad-goodbye value=1><span>Don't ask me again for 1 day</span></label><label class=give-freely-radio-option><input type=radio name=gf-rad-goodbye value=7><span>Don't ask me again for 7 days</span></label><label class=give-freely-radio-option><input type=radio name=gf-rad-goodbye value=30><span>Don't ask me again for 30 days</span></label><label class=give-freely-radio-option><input type=radio name=gf-rad-goodbye value=90><span>Don't ask me again for 90 days</span></label></div><button class=give-freely-submit-button>Submit");function at(e){const[t,n]=d(0);return r=st(),o=r.firstChild,i=o.firstChild,s=o.nextSibling,a=s.nextSibling.nextSibling,c=(l=a.firstChild).firstChild,g=(u=l.nextSibling).firstChild,m=(h=u.nextSibling).firstChild,A=(f=h.nextSibling).firstChild,b=a.nextSibling,r.style.setProperty("font-size","14px"),$(i,(()=>e.checkoutPopupConf.checkoutPopupSupressTitle)),$(o,D(I,{get when(){return e.checkoutPopupConf.checkoutPopupSupressCloseButtonVisible},get children(){var t=ot();return t.$$click=()=>e.onGoodbye(0),p((e=>F(t,ie,e))),t}}),null),s.$$click=()=>e.onBack(),c.addEventListener("change",(()=>n(1))),g.addEventListener("change",(()=>n(7))),m.addEventListener("change",(()=>n(30))),A.addEventListener("change",(()=>n(90))),$(a,D(I,{get when(){return e.checkoutPopupConf.checkoutPopupNeverSuppressionAllowed},get children(){var e=it();return e.firstChild.addEventListener("change",(()=>n(18250))),p((t=>F(e,me,t))),e}}),null),b.$$click=()=>{const n=t();n&&(e.onGoodbye(n),e.setScreen("main"))},p((t=>{var n=re,r=oe,c=Ae,g=he,d=me,p=me,m=me,A=me,x={...pe,"font-weight":"700","margin-top":"10px","margin-bottom":"0px","background-color":e.checkoutPopupConf.checkoutPopupSelectCharityButtonBgColor||"#FFD812",width:"100px"};return t.e=F(o,n,t.e),t.t=F(i,r,t.t),t.a=F(s,c,t.a),t.o=F(a,g,t.o),t.i=F(l,d,t.i),t.n=F(u,p,t.n),t.s=F(h,m,t.s),t.h=F(f,A,t.h),t.r=F(b,x,t.r),t}),{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),r;var r,o,i,s,a,l,c,u,g,h,m,f,A,b}N(["click"]);class lt{static formatMessage(e,...t){return e.replace(/{(\d+)}/g,((e,n)=>{const r=Number(n);return void 0!==t[r]?String(t[r]):`{${r}}`}))}}var ct=_("<div><p>"),ut=_("<div><div><div></div><button class=give-freely-close-button aria-label=Close>×</button></div><hr><div><span>");function gt(e){const[t,n]=d(null);let r;var o,i,a,l,c,u,g;return o=()=>clearInterval(r),null===s||(null===s.cleanups?s.cleanups=[o]:s.cleanups.push(o)),A((()=>{e.failedDonation||(()=>{const t=e.checkoutPopupConf.checkoutPopupDonationSuccessAutoCloseInSeconds??3;n(t),r=setInterval((()=>{n((t=>null===t||t<=1?(clearInterval(r),e.onClose(),0):t-1))}),1e3)})()})),i=ut(),a=i.firstChild,l=a.firstChild,c=l.nextSibling,u=a.nextSibling.nextSibling,g=u.firstChild,i.style.setProperty("font-size","14px"),$(l,(()=>e.failedDonation?"Oops! Something went wrong":e.checkoutPopupConf.checkoutPopupDonationTitle)),c.$$click=()=>e.onClose(),u.style.setProperty("padding","30px"),u.style.setProperty("height","150px"),u.style.setProperty("font-size","14px"),$(i,D(I,{get when(){return!e.failedDonation},get children(){var n=ct(),r=n.firstChild;return $(r,(()=>lt.formatMessage(e.checkoutPopupConf.checkoutPopupDonationSuccessAutoCloseLabelStringMask||"Closing in {0}",t()??0))),p((e=>F(r,fe,e))),n}}),null),p((t=>{var n=re,r=oe,o=ie,i=e.failedDonation?"Please try again later.":e.checkoutPopupConf.checkoutPopupDonationWording;return t.e=F(a,n,t.e),t.t=F(l,r,t.t),t.a=F(c,o,t.a),i!==t.o&&(g.innerHTML=t.o=i),t}),{e:void 0,t:void 0,a:void 0,o:void 0}),i}N(["click"]);var dt=_("<div><div>");const pt=(e,t,n)=>"donate"===e?"340px":t.checkoutPopupDisplayNameInFooter?"520px":n;function ht(e){const[t,n]=d("main"),[r,o]=d(),[i,s]=d(!1),a=()=>{e.logger.debug("Close button clicked"),e.onClose()},l=async(t,r=!1)=>{r&&e.onClose(),e.logger.info("Charity selected",{charity:t,domain:e.activeDomain.Domain}),o(t);const i=await e.onDonate(t,e.activeDomain);r?e.onClose():(s(!i),n("donate"))},c=()=>{e.logger.debug("Suppress button clicked"),n("goodbye")},u=()=>{e.logger.debug("Navigating back to main screen"),n("main")},g=t=>{e.logger.info("User chose to hide popup",{days:t}),e.onClose(t)};let h;return b=dt(),x=b.firstChild,"function"==typeof h?(m=h,A=x,f((()=>m(A,undefined)))):h=x,$(x,D(I,{get when(){return"main"===t()},get children(){return D(rt,{mainContainerRef:h,get checkoutPopupConf(){return e.checkoutPopupConf},get activeDomain(){return e.activeDomain},get merchantRates(){return e.merchantRates},onClose:a,onCharitySelect:l,onSuppress:c,get onOfferDetailsClick(){return e.onOfferDetailsClick},get subtitle(){return e.checkoutPopupConf.checkoutPopupSubTitle}})}}),null),$(x,D(I,{get when(){return"goodbye"===t()},get children(){return D(at,{get checkoutPopupConf(){return e.checkoutPopupConf},onClose:()=>e.onClose(),onBack:u,onGoodbye:g,setScreen:n})}}),null),$(x,D(I,{get when(){return"donate"===t()},get children(){return D(gt,{get checkoutPopupConf(){return e.checkoutPopupConf},get selectedCharity(){return r()},onClose:()=>e.onClose(),get failedDonation(){return i()},setScreen:n})}}),null),p((n=>{var r={...ee,height:pt(t(),e.checkoutPopupConf,ee.height)},o=e.elementId,i=te;return n.e=F(b,r,n.e),o!==n.t&&L(b,"id",n.t=o),n.a=F(x,i,n.a),n}),{e:void 0,t:void 0,a:void 0}),b;var m,A,b,x}function mt(e){const t=["",".asp",".aspx",".php",".js",".htm",".html"],n=["cart","checkout","shopping-bag","shopping-basket","shopping-cart","basket"].flatMap((e=>t.map((t=>e+t)))).filter((e=>"basket"!==e)),r=["tote-cart","tote.cart"],o=e,i=n.filter((e=>o.includes(e))),s=o.split("/");return!s.some((e=>r.some((t=>e.includes(t)))))&&(s.some((e=>n.some((t=>e.startsWith(t)||e.endsWith(t)))))||"basket"===s[s.length-1].toLowerCase()||i.length>1||1===i.length&&o.includes("shopping"))}function ft(e,t){const n=["book"];return e.split("/").some((e=>n.some((t=>e.startsWith(t)||e.endsWith(t)))))&&null!=t.evaluate("//*[self::h1 or self::h2 or self::h3 or self::h4  or self::h5  or self::h6][contains(., 'Your Reservation') or contains(., 'Your reservation')]",t,null,XPathResult.ANY_TYPE,null)?.iterateNext()}async function At(e){try{const t=await J({type:Ye,payload:{shopId:e}});return t.payload.found&&t.payload.domain?t.payload.domain:null}catch{return null}}function bt(e){try{const e=Array.from(document.querySelectorAll("script"));for(const t of e){if(t.dataset?.shopId&&(t.dataset?.shopId?.startsWith("gid")||t.src.includes("shopify"))){const e=parseInt(t.dataset.shopId.replace("gid://shopify/Shop/",""));if(!Number.isNaN(e)&&e>0)return e}const e=t.textContent||"";if(e.includes("ShopifyAnalytics")&&e.includes("shopId")){const t=e.match(/shopId['"]*:\s*['"]*(\d+)['"]*[,}]/);if(t&&t[1]){const e=parseInt(t[1]);if(!Number.isNaN(e)&&e>0)return e}}}const t=document.querySelector("[data-shop-id]");if(t instanceof HTMLElement){const{shopId:e}=t.dataset;if(e){const t=parseInt(e);if(!Number.isNaN(t)&&t>0)return t}}const n=window?.ShopifyAnalytics?.lib?.trekkie?.defaultAttributes?.shopId;return n&&parseInt(n)||0}catch(t){return e.error("Error accessing ShopifyAnalytics:",t),0}}function xt(){try{if(!window.location.href.startsWith("https://shop.app"))return 0;const e=document?.head?.querySelector('meta[name="store"][content]');if(!e)return 0;try{const t=JSON.parse(e.content);return t?.id||0}catch{return 0}}catch{return 0}}const vt=Y.getInstance();function yt(e,t,n){try{const r=function(e){try{const t=e.split(".");return t.length>=2?t.slice(-2).join("."):e}catch(e){return vt.error("Error extracting domain",e),""}}(n);vt.debug("Checking merchant regex rules",{currentDomain:r,currentUrl:t});const o=e.merchantPopupRules.filter((e=>r.includes(e.domain)));if(0===o.length)return vt.debug("No matching merchant rules found for domain",{currentDomain:r}),!1;for(const e of o)for(const n of e.rules)try{if(new RegExp(n.rule).test(t))return vt.debug("Merchant regex rule matched",{merchant:e.name,rule:n.rule,currentUrl:t}),!0}catch(t){vt.error("Invalid regex in merchant rule",{merchant:e.name,rule:n.rule,error:t})}return vt.debug("No matching regex rules found",{currentUrl:t}),!1}catch(e){return vt.error("Error in merchantRegexRule",e),!1}}function wt(){const e=document.documentElement.lang,t=document.querySelector('meta[http-equiv="Content-Language"]')?.content,n=document.querySelector('link[rel="alternate"][hreflang]')?.getAttribute("hreflang"),r=navigator.language,o=e||t||n||r||"en";return"string"==typeof o?o.split("-")[0]:"en"}function Ct(e){return!0!==e.checkoutPopupOnlyShowLanguageMatch||"en"===wt()}const kt=(e,t=!1)=>e.length<2&&t?null:Array.from(e).filter((e=>!t||e.dataset.extensionId!==Z.runtime.id)).map((e=>e.dataset.extensionName)).join(",");var Pt=_("<div class=gf-app>");function St(){const e=Y.getInstance(),[t,n]=d(null),[r,o]=d(void 0),[i,s]=d(!1),[a,l]=d([]);A((async()=>{e.info("Mounting GfApp component");try{const i=await(async()=>{const e=await J({type:Be,payload:{}});if(!e.payload.config)throw new Error("No checkout popup config found");return e.payload.config})();if(!i)return void e.error("No checkout popup config found");n(i),e.configure({enabled:!0,title:"Content - GfAdUnit",minLevel:i.checkoutPopupMinLogLevel??"error"}),function(e){if(!e?.shouldCheckSiteMatches)return;let t;(e?.siteMatchesRegex??[]).some((e=>{var n;return n=window.location.href,!(!new RegExp(e).test(n)||(t=e,0))}))&&t&&Xe.trackEvent(K.checkoutPopupSiteMatches,{url:window.location.href,matchedRule:t,uts:Date.now()},!0)}(i);const a=qe();if(i.minVersion&&((e,t)=>{if(e===t)return!1;const n=e.split(".").map((e=>parseInt(e,10))),r=t.split(".").map((e=>parseInt(e,10)));for(let e=0;e<n.length;e++){if(n[e]<r[e])return!0;if(n[e]>r[e])return!1}return!1})(a,i.minVersion))return void e.debug(`Current version: ${a}.  Minimum version ${i.minVersion} not met`);if(!1===i.checkoutPopupMasterSwitch)return void e.debug("Checkout popup master switch is disabled");const c=document.getElementsByClassName("give-freely-root");let u=!1;c.length>1&&(e.debug("There is more than one gf extension installed"),c.item(0).dataset.extensionId!==Z.runtime.id&&(e.debug("Giving preference to the first gf extension injected in the DOM"),u=!0),e.debug("Providing this extension preference over the other installed extensions"));const{domain:g,rates:d}=await(async e=>{const{hostname:t}=window.location;e.debug("Checking if domain is active",{hostname:t});const n=await J({type:je,payload:{hostname:t}});return n.payload.isActive?(e.debug("Active domain",{domain:n.payload.domain}),e.debug("Merchant rates",{rates:n.payload.rates}),e.info("Domain and rates ({})ed successfully."),{isActive:!0,domain:n.payload.domain,rates:n.payload.rates}):{isActive:!1,domain:void 0,rates:[]}})(e);if(l(d),o(g),g)await function(e,t){const n=bt(t)||xt();return n>0&&function(e,t,n){if(e&&!(e<=0))try{J({type:Ve,payload:{shopId:e,domain:t}}).catch((e=>{n.error("Error sending shop ID to background:",e)}))}catch(e){n.error("Error sending Shopify shop ID:",e)}}(n,e,t),n}(g,e);else{if("shop.app"!==window.location.hostname&&!window.location.hostname.endsWith(".shop.app"))return void s(!1);const t=window.location.pathname.split("/")[2];if(!t)return e.error("Shop ID not found"),void s(!1);const n=await At(parseInt(t));if(!n)return e.error("Shop domain not found"),void s(!1);e.debug("Shop domain found",{shopDomain:n}),o(n)}const p=await(async e=>{const t=await Me.get("popup_hide");if(!t)return e.debug("No expiry found in storage"),!1;const{popupHide:n}=t,r=!!n&&Date.now()<n;return e.debug("Is AdUnit Muted?",{isMuted:r,expiry:n}),r})(e);if(p)return;if(!r())return void s(!1);const h=await(async(e,t)=>{const{Domain:n}=t,r=window.location.href,{payload:o}=await J({type:Ke,payload:{activeDomain:n,url:r}});return!!o.result&&(e.info("Stand Down detected"),!0)})(e,r());if(h)return void s(!1);const m=t()?.anonymousActiveDomainLogging??!1,f=r()??void 0;f&&m&&!function(e){const t=`gfhv-${e}`;return!!sessionStorage.getItem(t)||(sessionStorage.setItem(t,"true"),!1)}(f.Domain)&&Xe.trackEvent(K.checkoutPopupActiveDomain,{url:f.Domain});const A=setInterval((async()=>{e.debug("Checking checkout rules");const t=await(async e=>{const t=Y.getInstance();t.configure({enabled:!0,title:"Content - checkoutRulesTest"});const n=new URL(globalThis.location.href),r=n.href,{hostname:o}=n;t.debug("Checking if popup should be shown",{currentUrl:r});const i=await async function(e){const t=bt(e)||xt();return!("shop.app"!==window.location.hostname&&!window.location.hostname.endsWith(".shop.app")||!(t>0)||!await At(t))}(t),s=Ct(e)&&(mt(n.pathname.toLowerCase())||ft(r,document)||yt(e,r,o)||i);return t.debug("Popup show decision based on rules",{shouldShow:s,matchesCartRule:mt(n.pathname.toLowerCase()),matchesBookingRule:ft(r,document),matchesShopPayRule:i,matchesMerchantRegexRule:yt(e,r,o),matchesLanguageRule:Ct(e)}),s})(i);if(t&&u)return Xe.trackEvent(K.checkoutPopupLooserExtension,{url:globalThis.window.location.href,winner:c.item(0).dataset.extensionName}),e.debug("Standing down because, another ad-unit extension will pop"),void clearInterval(A);if(s(t),t){e.debug("Should show popup based on checkout rules",{shouldShowResult:t});const n=wt();Xe.trackEvent(K.checkoutPopupShown,{url:globalThis.window.location.href,pageLanguage:n,looserCompetingExtensions:kt(c,!0)}),clearInterval(A)}}),2e3)}catch(t){s(!1),e.error("An error occurred in GfApp",{error:t})}}));const c=async(t,n)=>{e.info("Processing donation",{charity:t,domain:n.Domain});const r=await(async(e,t,n,r)=>{e.debug("Activating offer",{activeDomain:t,selectedCharity:r});const o=await Q({type:We,payload:{activeDomain:t,originalUrl:n,selectedCharity:r}});return e.debug("Activate offer response",{response:o}),o})(e,n,window.location.href,{ein:t.ein,thirdPartyId:t.tpi});return e.debug("Activate offer response",{activationResponse:r}),Xe.trackEvent(r.payload.response?K.checkoutPopupDonation:K.checkoutPopupFailedActivation,{activeDomain:n.Domain,url:globalThis.window.location.href,charity:{ein:t.ein,tpi:t.tpi},rate:n.Merchant.MaxRate}),r.payload.response},u=async t=>{s(await(async(e,t)=>{try{e.info("Hiding ad",{days:t});const n=await Q({type:He,payload:{days:t??0}});return void 0!==t&&Xe.trackEvent(K.checkoutPopupSupressed,{url:globalThis.window.location.href,days:t}),e.info("Hiding ad response",{hideResponse:n}),n.payload.ack?(e.debug("Ad hidden successfully"),!1):(e.warn("Failed to hide ad"),!0)}catch{return!1}})(e,t))},g=async e=>{Xe.trackEvent(K.checkoutPopupOfferDetailsClicked,{action:e?"opened":"closed"})};return $(h=Pt(),(p=m((()=>!(!r()||!i()))),()=>p()&&D(ht,{get checkoutPopupConf(){return t()},elementId:"give-freely-checkout-popup",get activeDomain(){return r()},get merchantRates(){return a()},onClose:u,onDonate:c,onOfferDetailsClick:g,logger:e}))),h;var p,h}e.browser=Z,e.initializeAdUnit=async function(){const e=`give-freely-root-${Z.runtime.id}`;if(document.getElementById(e))return;const t=document.createElement("div");t.id=e,t.className="give-freely-root",t.style.display="block",t.dataset.extensionId=Z.runtime.id,t.dataset.extensionName=Z.runtime.getManifest().name||Z.runtime.id,document.body.appendChild(t);const n=t.attachShadow({mode:"open"}),r=document.createElement("div"),o=document.createElement("style");o.textContent='\n  :host {\n    all: initial;\n  }\n\n  .gf-scroll-remove::-webkit-scrollbar {\n    border-radius-bottom-right: 15px;\n  }\n\n  button {\n    cursor: pointer;\n    transition: transform 0.1s ease;\n  }\n\n  button:active {\n    transform: scale(0.98);\n  }\n\n  .give-freely-close-button:hover {\n    opacity: 0.7;\n  }\n\n  input[type="radio"] {\n    margin-right: 8px;\n  }\n\n  hr {\n    border: none;\n    border-top: 1px solid #e5e5e5;\n    margin: 1em 0;\n  }\n\n  @media (max-width: 600px), (max-height: 480px) {\n    #give-freely-checkout-popup {\n      display: none !important;\n    }\n  }\n',n.appendChild(o),n.appendChild(r),function(e,t,n,r={}){let o;(function(e,t){const n=l,r=s,o=0===e.length,a=void 0===t?r:t,c=o?i:{owned:null,cleanups:null,context:a?a.context:null,owner:a},u=o?e:()=>e((()=>f((()=>T(c)))));s=c,l=null;try{return C(u,!0)}finally{l=n,s=r}})((r=>{o=r,t===document?e():$(t,e(),t.firstChild?null:void 0,n)}),r.owner)}((()=>D(St,{})),r)}}));
